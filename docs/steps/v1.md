# WalletWise v1.x

> Dashboard de Finanzas Personales - Single User Edition

**Version actual:** 1.1.0
**Estado:** Completado
**Fecha de lanzamiento:** Enero 2026

---

## Descripcion

WalletWise es un dashboard de finanzas personales completo para un solo usuario. Permite gestionar ingresos, gastos, transferencias, presupuestos, inventario y reportes con soporte multi-moneda, incluyendo criptomonedas.

---

## Features Implementadas

### Modulos Core

| Modulo         | Descripcion                                                 |
| -------------- | ----------------------------------------------------------- |
| Dashboard      | KPIs, graficos, transacciones recientes, gastos pendientes  |
| Accounts       | Cuentas bancarias, efectivo, billeteras digitales, tarjetas |
| Jobs           | Trabajos fijos y freelance con generacion de ingresos       |
| Incomes        | Registro de ingresos con paginacion                         |
| Expenses       | Gastos unicos y recurrentes con procesamiento automatico    |
| Transfers      | Transferencias entre cuentas y budgets con conversion       |
| Budgets        | Presupuestos (envelope/goal) con bloqueo de saldo           |
| Categories     | Categorias jerarquicas para clasificar gastos               |
| Exchange Rates | Tasas de cambio con sync desde API oficial y Binance P2P    |
| Reports        | Reportes financieros con export CSV, JSON y PDF             |
| Inventory      | Gestion de inventario con historial de precios              |
| Shopping List  | Lista de compras generada desde inventario                  |
| Settings       | Configuracion de usuario (formato fecha, moneda, tema)      |

### Features v1.0.0 (Base)

| Feature            | Descripcion                                           |
| ------------------ | ----------------------------------------------------- |
| Paginacion         | Endpoints paginados para expenses, incomes, transfers |
| Backup/Restore     | Export/import JSON y CSV completo                     |
| Multi-moneda       | Soporte para USD, COP, VES con conversiones           |
| Gastos Recurrentes | UI para ver y procesar gastos periodicos              |
| Export PDF         | Generacion de reportes en PDF                         |

### Features v1.1.0 (Mejoras)

| Feature                  | Descripcion                                         |
| ------------------------ | --------------------------------------------------- |
| Criptomonedas            | Soporte para USDT, BTC, ETH, BNB, SOL               |
| Tasas Binance P2P        | Sync de tasas crypto/fiat desde Binance             |
| Tasas con cooldown       | Minimo 6 horas entre sincronizaciones               |
| Tasa custom en forms     | Ingreso de tasa manual con calculo de diferencia    |
| Sidebar con dropdowns    | Items agrupados en categorias colapsables           |
| Dashboard mejorado       | Quick actions, widget tasas, widget ahorro          |
| Budgets con bloqueo      | Ambos tipos bloquean saldo de cuenta                |
| Transfers budget         | Transferencias account-budget y budget-account      |
| Vista cuentas mejorada   | Total / Disponible / Bloqueado con barra visual     |
| Settings completo        | Moneda base, formato fecha, formato numeros, tema   |
| Formatters centralizados | UserConfigContext con useFormatters hook            |
| Historial con tasas      | Columna de tasas en tablas con detalles expandibles |
| Rate details popover     | Popover con oficial/custom/diferencia               |

---

## Stack Tecnologico

| Capa            | Tecnologia                       |
| --------------- | -------------------------------- |
| Frontend        | Next.js 16, React 19, TypeScript |
| Estilos         | Tailwind CSS 4                   |
| Estado/Fetching | TanStack Query                   |
| Backend         | Next.js API Routes               |
| ORM             | Prisma 6                         |
| Base de Datos   | PostgreSQL 16                    |
| Graficos        | Recharts                         |
| PDF             | jsPDF + jspdf-autotable          |
| Contenedores    | Docker Compose                   |

---

## Arquitectura

### Estructura de Carpetas

```
app/
├── dashboard/              # Rutas del dashboard
│   ├── page.tsx            # Dashboard principal
│   ├── _components/        # Componentes del dashboard
│   ├── accounts/
│   ├── budgets/
│   ├── categories/
│   ├── currencies/
│   ├── exchange-rates/
│   ├── expenses/
│   ├── incomes/
│   ├── inventory/
│   ├── jobs/
│   ├── reports/
│   ├── settings/
│   └── transfers/
└── api/                    # REST endpoints
    └── [modulo]/
        ├── route.ts        # GET, POST
        ├── [id]/route.ts   # GET, PUT, DELETE
        ├── service.ts      # Logica de negocio
        ├── repository.ts   # Queries Prisma
        ├── schema.ts       # Validacion Zod
        └── types.ts        # Interfaces

lib/
├── prisma.ts               # Cliente Prisma
├── pagination.ts           # Utilidades paginacion
├── export-utils.ts         # Export PDF/CSV
├── binance-p2p.ts          # Cliente Binance P2P
├── date-utils.ts           # Formatters de fecha
├── number-utils.ts         # Formatters de numeros
└── utils.ts                # Utilidades generales

contexts/
└── user-config-context.tsx # Contexto de configuracion

hooks/
├── use-exchange-rate.ts    # Hook para tasas
└── use-user-config.ts      # Hook para config usuario

components/
├── ui/                     # Componentes shadcn/ui
├── layout/                 # Sidebar, Header
├── exchange-rate-display.tsx
├── rate-details-popover.tsx
└── backup-modal.tsx
```

### Modelo de Datos Principal

```
Currency (USD, COP, VES, USDT, BTC, ETH, BNB, SOL)
    │
    ├── Account ─────────────────────┐
    │       │                        │
    │       ├── Income ◄── Job       │
    │       │                        │
    │       ├── Expense ◄── Category │
    │       │                        │
    │       └── Transfer ────────────┘
    │               │
    │               └── Budget (fromBudget/toBudget)
    │
    ├── ExchangeRate (source: official/binance/manual)
    │
    ├── Budget ◄── BudgetContribution
    │
    ├── UserConfig (formato, tema, sidebar)
    │
    └── InventoryItem ◄── InventoryPriceHistory
            │
            └── ShoppingList
```

---

## Schema Highlights

### Transfer Types

```prisma
enum TransferType {
  account_to_account
  account_to_budget
  budget_to_account
}

model Transfer {
  type          TransferType @default(account_to_account)
  fromAccountId String?
  toAccountId   String?
  fromBudgetId  String?
  toBudgetId    String?
  exchangeRate  Decimal?     // Tasa usada
  officialRate  Decimal?     // Tasa oficial al momento
  customRate    Decimal?     // Tasa ingresada manualmente
}
```

### Exchange Rate Sources

```prisma
enum ExchangeRateSource {
  official
  binance
  manual
}

model ExchangeRate {
  source ExchangeRateSource @default(official)
}
```

### User Configuration

```prisma
model UserConfig {
  baseCurrencyId  String
  dateFormat      String   @default("DD/MM/YYYY")
  numberFormat    String   @default("es-CO")
  theme           String   @default("system")
  sidebarConfig   Json     @default("[]")
  lastRateSyncAt  DateTime?
}
```

---

## Endpoints API

### Transacciones

| Metodo | Endpoint                     | Descripcion               |
| ------ | ---------------------------- | ------------------------- |
| GET    | `/api/incomes`               | Listar ingresos           |
| POST   | `/api/incomes`               | Crear ingreso             |
| GET    | `/api/expenses`              | Listar gastos             |
| POST   | `/api/expenses`              | Crear gasto               |
| POST   | `/api/expenses/[id]/process` | Procesar gasto recurrente |
| GET    | `/api/transfers`             | Listar transferencias     |
| POST   | `/api/transfers`             | Crear transferencia       |

### Entidades

| Metodo | Endpoint                       | Descripcion         |
| ------ | ------------------------------ | ------------------- |
| GET    | `/api/accounts`                | Listar cuentas      |
| GET    | `/api/accounts/[id]/blocked`   | Saldo bloqueado     |
| GET    | `/api/jobs`                    | Listar trabajos     |
| GET    | `/api/budgets`                 | Listar presupuestos |
| POST   | `/api/budgets/[id]/contribute` | Contribuir a budget |
| POST   | `/api/budgets/[id]/withdraw`   | Retirar de budget   |
| GET    | `/api/categories`              | Listar categorias   |

### Configuracion

| Metodo | Endpoint                           | Descripcion               |
| ------ | ---------------------------------- | ------------------------- |
| GET    | `/api/user-config`                 | Obtener configuracion     |
| PUT    | `/api/user-config`                 | Actualizar configuracion  |
| POST   | `/api/exchange-rates/sync`         | Sincronizar tasas oficial |
| POST   | `/api/exchange-rates/sync/binance` | Sync tasas Binance        |

### Utilidades

| Metodo | Endpoint         | Descripcion          |
| ------ | ---------------- | -------------------- |
| GET    | `/api/backup`    | Export datos         |
| POST   | `/api/backup`    | Import datos         |
| GET    | `/api/dashboard` | KPIs y metricas      |
| GET    | `/api/reports`   | Reportes financieros |

---

## Componentes Principales

| Componente          | Ubicacion                | Descripcion                        |
| ------------------- | ------------------------ | ---------------------------------- |
| ExchangeRateDisplay | `components/`            | Tasa oficial/custom con diferencia |
| RateDetailsPopover  | `components/`            | Popover con detalles de conversion |
| QuickActionButton   | `dashboard/_components/` | Boton accion rapida                |
| ContributeModal     | `budgets/_components/`   | Modal para contribuir a budget     |
| WithdrawModal       | `budgets/_components/`   | Modal para retirar de budget       |
| AccountBalanceCard  | `accounts/_components/`  | Card con barra visual              |
| SavingsWidget       | `dashboard/_components/` | Widget de ahorro por tasas         |
| Sidebar             | `components/layout/`     | Sidebar con dropdowns              |

---

## Seed Data

```typescript
const currencies = [
  // Fiat
  { code: "USD", name: "Dolar estadounidense", symbol: "$", isBase: true },
  { code: "COP", name: "Peso colombiano", symbol: "COP$" },
  { code: "VES", name: "Bolivar venezolano", symbol: "Bs." },
  // Crypto
  { code: "USDT", name: "Tether", symbol: "USDT" },
  { code: "BTC", name: "Bitcoin", symbol: "BTC" },
  { code: "ETH", name: "Ethereum", symbol: "ETH" },
  { code: "BNB", name: "Binance Coin", symbol: "BNB" },
  { code: "SOL", name: "Solana", symbol: "SOL" },
];

const accountTypes = [
  { name: "Cuenta Bancaria", type: "bank" },
  { name: "Efectivo", type: "cash" },
  { name: "Billetera Digital", type: "digital_wallet" },
  { name: "Tarjeta de Credito", type: "credit_card" },
];
```

---

## Comandos

```bash
# Desarrollo
yarn dev              # Servidor desarrollo
yarn build            # Build produccion
yarn lint             # Linter
yarn typecheck        # Verificar tipos

# Base de datos
yarn db:generate      # Generar cliente Prisma
yarn db:migrate       # Aplicar migraciones
yarn db:seed          # Datos iniciales
yarn db:studio        # Prisma Studio

# Docker
docker-compose up -d  # Levantar PostgreSQL
```

---

## Limitaciones

| Limitacion         | Descripcion                           |
| ------------------ | ------------------------------------- |
| Single User        | Solo un usuario puede usar el sistema |
| Sin Auth           | No hay login ni registro              |
| Local Only         | Datos solo en la instancia local      |
| Sin Notificaciones | No hay alertas push                   |
| Sin PWA            | No es instalable como app             |

---

## Metricas

| Metrica          | Valor   |
| ---------------- | ------- |
| Modulos          | 13      |
| Endpoints API    | 50+     |
| Componentes UI   | 50+     |
| Lineas de codigo | ~20,000 |

---

_WalletWise v1.1.0 - Single User Edition (Completado)_
